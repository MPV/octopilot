<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><meta name=generator content="Hugo 0.84.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Octopilot</title><link rel="shortcut icon" href=favicon.ico type=image/x-icon><link href="https://fonts.googleapis.com/css?family=Open+Sans" rel=stylesheet><link rel=stylesheet href=css/styles.css><link rel=stylesheet href=css/custom.css><link href rel=alternate type=application/rss+xml title=Octopilot></head><body><div class="sidebar sidebar-dailymotion"><div class=navigation><h1 class=site-title><a href>Octopilot</a> v0.2.15</h1><nav class=internal><ul><li><a href=#intro>Introduction</a></li><li><a href=#usage>Usage</a></li><li><a href=#repos>Repositories</a><ul><li><a href=#static>Static list</a></li><li><a href=#dynamic>Dynamic list</a></li><li><a href=#commit>Commits</a></li><li><a href=#pull-request>Pull Requests</a></li></ul></li><li><a href=#updaters>Updaters</a><ul><li><a href=#yaml>YAML</a></li><li><a href=#yq>YQ</a></li><li><a href=#helm>Helm</a></li><li><a href=#sops>Sops</a></li><li><a href=#regex>Regex</a></li><li><a href=#exec>Exec</a></li></ul></li><li><a href=#github>GitHub</a><ul><li><a href=#auth>Auth</a></li></ul></li><li><a href=#faq>FAQ</a></li></ul></nav><nav class=external><div class=external-title></div><ul id=shortcuts><li><a href=https://github.com/dailymotion-oss/octopilot target=_blank rel=noopener>Source Code</a></li></ul></nav></div><div class=version>v0.2.15 released on Jul 5, 2021</div></div><div class=content><section class="page changelog" id=changelog><h1><a href=https://github.com/dailymotion-oss/octopilot/releases/tag/v0.2.15>Documentation for Octopilot v0.2.15 - released on Jul 5, 2021</a></h1><div class=content><p>This is the full documentation for <a href=https://github.com/dailymotion-oss/octopilot/releases/tag/v0.2.15>Octopilot v0.2.15</a>.</p><h2 id=changelog>Changelog</h2><h3 id=ci>CI</h3><ul><li><strong>release:</strong> ensure we retrieve the submodules too</li></ul></div></section><section class=page id=intro><h1><a href=#intro>Introduction</a></h1><div class=content><p><strong>Octopilot</strong> is a CLI tool designed to help you automate your Gitops workflow, by automatically creating and merging GitHub Pull Requests to update specific content in Git repositories.</p><p>It works by:</p><ul><li>cloning one or more <a href=#repos>repositories</a>, defined either:<ul><li><a href=#static>statically</a></li><li><a href=#dynamic>dynamically</a>, using environment variables or GitHub search queries</li></ul></li><li>running one or more <a href=#updaters>updaters</a> on each cloned repository, using either:<ul><li>the <a href=#yaml>YAML updater</a>, to quickly update YAML files</li><li>the <a href=#yq>YQ updater</a>, based on <a href=https://github.com/mikefarah/yq>mikefarah&rsquo;s yq</a>, to manipulate YAML or JSON files as you want</li><li>the <a href=#helm>Helm updater</a>, to easily update the dependencies of an <a href=https://helm.sh/>Helm</a> chart</li><li>The <a href=#sops>sops updater</a>, to manipulate files encrypted with <a href=https://github.com/mozilla/sops>mozilla&rsquo;s sops</a></li><li>The <a href=#regex>regex updater</a>, to update any kind of text file using a regular expression</li><li>The <a href=#exec>exec updater</a>, to execute any command you want</li></ul></li><li><a href=#commit>commit/push</a> the changes</li><li>create <a href=#pull-request>Pull Requests</a> and optionally merge them</li></ul></div></section><section class=page id=usage><h1><a href=#usage>Usage</a></h1><div class=content><p>You can download the binary or see the <code>docker pull</code> commands from the <a href=https://github.com/dailymotion-oss/octopilot/releases/latest>release page on GitHub</a>.</p><p>There are no dependencies - not even on <code>git</code>.</p><p>There are no configuration files - we use CLI flags for everything. You can run <code>octopilot -h</code> to see all the flags. Some of them can be use multiple times, such as the <code>--repo</code> or <code>--update</code> flags.</p><p>Here is an example of using Octopilot to update multiple repositories, using multiple updaters:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>$ octopilot \
    --repo &#34;my-org/some-repo(merge=true)&#34; \
    --repo &#34;my-org/another-repo(draft=true)&#34; \
    --repo &#34;discover-from(env=PROMOTE_TO_REPOSITORIES)&#34; \
    --repo &#34;discover-from(query=org:my-org topic:my-topic)&#34; \
    --update &#34;yaml(file=config.yaml,path=&#39;version&#39;)=file(path=VERSION)&#34; \
    --update `yq(file=helmfile.yaml,expression=&#39;(.releases[] | select(.chart == &#34;repo/my-chart&#34;) | .version ) = strenv(VERSION)&#39;)` \
    --update `sops(file=secrets.yaml,key=path.to.base64encodedCertificateKey)=$(kubectl -n cert-manager get secrets tls-myapp -o template=&#39;{{index .data &#34;tls.key&#34;}}&#39;)` \
    --pr-title &#34;Updating some files&#34; \
    ...
</code></pre></div></div></section><section class=page id=repos><h1><a href=#repos>Repositories</a></h1><div class=content><p>Octopilot operates on GitHub repositories. A single execution of Octopilot can update one or more repositories. There are 2 ways to define the repositories to update:</p><ul><li>using a <a href=#static>static list</a></li><li>using a <a href=#dynamic>dynamic list</a></li></ul></div></section><section class=page id=static><h1><a href=#static>Static list</a></h1><div class=content><p>It is the easiest: just specify the repositories on the CLI using the <code>--repo</code> flag, such as:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>$ octopilot \
    --repo &#34;my-github-org/my-first-repo(merge=true)&#34; \
    --repo &#34;my-github-org/my-second-repo(draft=true)&#34;
</code></pre></div><p>You can add as much repositories as you want, each with different configuration.</p><p>We support the following parameters:</p><ul><li><code>merge</code> (boolean): if <code>true</code>, then the PR created on this repository will be automatically merged - see the <a href=#pull-request>Pull Requests</a> section for more details. It overrides the value of the <code>--pr-merge</code> flag for this specific repository.</li><li><code>draft</code> (boolean): if <code>true</code>, then the PR will be created as a <a href=https://github.blog/2019-02-14-introducing-draft-pull-requests/>draft PR</a> on GitHub. You will need to manually mark it as &ldquo;ready for review&rdquo; before being able to merge it. It overrides the value of the <code>--pr-draft</code> flag for this specific repository.</li></ul></div></section><section class=page id=dynamic><h1><a href=#dynamic>Dynamic list</a></h1><div class=content></div></section><section class=page id=commit><h1><a href=#commit>Commits</a></h1><div class=content></div></section><section class=page id=pull-request><h1><a href=#pull-request>Pull Requests</a></h1><div class=content></div></section><section class=page id=updaters><h1><a href=#updaters>Updaters</a></h1><div class=content></div></section><section class=page id=yaml><h1><a href=#yaml>YAML</a></h1><div class=content></div></section><section class=page id=yq><h1><a href=#yq>YQ</a></h1><div class=content></div></section><section class=page id=helm><h1><a href=#helm>Helm</a></h1><div class=content></div></section><section class=page id=sops><h1><a href=#sops>Sops</a></h1><div class=content></div></section><section class=page id=regex><h1><a href=#regex>Regex</a></h1><div class=content></div></section><section class=page id=exec><h1><a href=#exec>Exec</a></h1><div class=content></div></section><section class=page id=github><h1><a href=#github>GitHub</a></h1><div class=content></div></section><section class=page id=auth><h1><a href=#auth>Auth</a></h1><div class=content></div></section><section class=page id=faq><h1><a href=#faq>FAQ</a></h1><div class=content></div></section></div></body></html>