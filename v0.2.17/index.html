<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.84.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Octopilot - Octopilot</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=favicon.png><link rel=stylesheet href=css/style.893557bc36f9dfda17c26bcf9db87c3f52ed314bc1fc66448453774f79f6ab02.css></head><body class="page page-default-single"><div class=wrapper><div class=header><div class=container><div class=logo><a href=/>Octopilot</a></div><div id=main-menu class=main-menu><ul><li class=menu-item-><a href=https://github.com/dailymotion-oss/octopilot><span>GitHub</span></a></li><li class=menu-item-><a href=https://github.com/dailymotion-oss><span>Dailymotion</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class=sidebar><div class=docs-menu><div class=navigation><nav class=internal><ul><li><a href=#intro>Introduction</a></li><li><a href=#usage>Usage</a></li><li><a href=#repos>Repositories</a><ul><li><a href=#static>Static list</a></li><li><a href=#dynamic>Dynamic list</a></li><li><a href=#commit>Commits</a></li><li><a href=#pull-request>Pull Requests</a></li></ul></li><li><a href=#updaters>Updaters</a><ul><li><a href=#yaml>YAML</a></li><li><a href=#yq>YQ</a></li><li><a href=#helm>Helm</a></li><li><a href=#sops>Sops</a></li><li><a href=#regex>Regex</a></li><li><a href=#exec>Exec</a></li></ul></li><li><a href=#github>GitHub</a><ul><li><a href=#auth>Auth</a></li></ul></li><li><a href=#faq>FAQ</a></li></ul></nav><nav class=external><div class=external-title></div><ul id=shortcuts><li><a href=https://github.com/dailymotion-oss/octopilot target=_blank rel=noopener>Source Code</a></li></ul></nav></div><div class=version>v0.2.17 released on Jul 9, 2021</div></div></div></div><div class="col-12 col-md-9"><h1 class=title>Documentation for Octopilot v0.2.17</h1><h2>Released on Jul 9, 2021</h2><div class=content><section class=changelog><div class=content><p>This is the full 1-page documentation for <a href=https://github.com/dailymotion-oss/octopilot/releases/tag/v0.2.17>Octopilot v0.2.17</a>.</p><h2 id=changelog>Changelog</h2><h3 id=documentation>Documentation</h3><ul><li>change theme used for current-version docs (<a href=https://github.com/dailymotion-oss/octopilot/issues/68>#68</a>)</li></ul></div></section><section id=intro><h1><a href=#intro>Introduction</a></h1><div class=content><p><strong>Octopilot</strong> is a CLI tool designed to help you automate your Gitops workflow, by automatically creating and merging GitHub Pull Requests to update specific content in Git repositories.</p><p>It works by:</p><ul><li>cloning one or more <a href=#repos>repositories</a>, defined either:<ul><li><a href=#static>statically</a></li><li><a href=#dynamic>dynamically</a>, using environment variables or GitHub search queries</li></ul></li><li>running one or more <a href=#updaters>updaters</a> on each cloned repository, using either:<ul><li>the <a href=#yaml>YAML updater</a>, to quickly update YAML files</li><li>the <a href=#yq>YQ updater</a>, based on <a href=https://github.com/mikefarah/yq>mikefarah&rsquo;s yq</a>, to manipulate YAML or JSON files as you want</li><li>the <a href=#helm>Helm updater</a>, to easily update the dependencies of an <a href=https://helm.sh/>Helm</a> chart</li><li>The <a href=#sops>sops updater</a>, to manipulate files encrypted with <a href=https://github.com/mozilla/sops>mozilla&rsquo;s sops</a></li><li>The <a href=#regex>regex updater</a>, to update any kind of text file using a regular expression</li><li>The <a href=#exec>exec updater</a>, to execute any command you want</li></ul></li><li><a href=#commit>commit/push</a> the changes</li><li>create <a href=#pull-request>Pull Requests</a> and optionally merge them</li></ul></div></section><section id=usage><h1><a href=#usage>Usage</a></h1><div class=content><p>You can download the binary or see the <code>docker pull</code> commands from the <a href=https://github.com/dailymotion-oss/octopilot/releases/latest>release page on GitHub</a>.</p><p>There are no dependencies - not even on <code>git</code>.</p><p>There are no configuration files - we use CLI flags for everything. You can run <code>octopilot -h</code> to see all the flags. Some of them can be use multiple times, such as the <code>--repo</code> or <code>--update</code> flags.</p><p>Here is an example of using Octopilot to update multiple repositories, using multiple updaters:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ octopilot \
    --repo &#34;my-org/some-repo(merge=true)&#34; \
    --repo &#34;my-org/another-repo(draft=true)&#34; \
    --repo &#34;discover-from(env=PROMOTE_TO_REPOSITORIES)&#34; \
    --repo &#34;discover-from(query=org:my-org topic:my-topic)&#34; \
    --update &#34;yaml(file=config.yaml,path=&#39;version&#39;)=file(path=VERSION)&#34; \
    --update `yq(file=helmfile.yaml,expression=&#39;(.releases[] | select(.chart == &#34;repo/my-chart&#34;) | .version ) = strenv(VERSION)&#39;)` \
    --update `sops(file=secrets.yaml,key=path.to.base64encodedCertificateKey)=$(kubectl -n cert-manager get secrets tls-myapp -o template=&#39;{{index .data &#34;tls.key&#34;}}&#39;)` \
    --pr-title &#34;Updating some files&#34; \
    ...
</code></pre></div></div></section><section id=repos><h1><a href=#repos>Repositories</a></h1><div class=content><p>Octopilot operates on GitHub repositories. A single execution of Octopilot can update one or more repositories. There are 2 ways to define the repositories to update:</p><ul><li>using a <a href=#static>static list</a></li><li>using a <a href=#dynamic>dynamic list</a></li></ul></div></section><section id=static><h1><a href=#static>Static list</a></h1><div class=content><p>It is the easiest: just specify the repositories on the CLI using the <code>--repo</code> flag, such as:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ octopilot \
    --repo &#34;my-github-org/my-first-repo(merge=true)&#34; \
    --repo &#34;my-github-org/my-second-repo(draft=true)&#34;
</code></pre></div><p>You can add as much repositories as you want, each with different configuration.</p><p>We support the following parameters:</p><ul><li><code>merge</code> (boolean): if <code>true</code>, then the PR created on this repository will be automatically merged - see the <a href=#pull-request>Pull Requests</a> section for more details. It overrides the value of the <code>--pr-merge</code> flag for this specific repository.</li><li><code>draft</code> (boolean): if <code>true</code>, then the PR will be created as a <a href=https://github.blog/2019-02-14-introducing-draft-pull-requests/>draft PR</a> on GitHub. You will need to manually mark it as &ldquo;ready for review&rdquo; before being able to merge it. It overrides the value of the <code>--pr-draft</code> flag for this specific repository.</li></ul></div></section><section id=dynamic><h1><a href=#dynamic>Dynamic list</a></h1><div class=content></div></section><section id=commit><h1><a href=#commit>Commits</a></h1><div class=content></div></section><section id=pull-request><h1><a href=#pull-request>Pull Requests</a></h1><div class=content></div></section><section id=updaters><h1><a href=#updaters>Updaters</a></h1><div class=content></div></section><section id=yaml><h1><a href=#yaml>YAML</a></h1><div class=content></div></section><section id=yq><h1><a href=#yq>YQ</a></h1><div class=content></div></section><section id=helm><h1><a href=#helm>Helm</a></h1><div class=content></div></section><section id=sops><h1><a href=#sops>Sops</a></h1><div class=content></div></section><section id=regex><h1><a href=#regex>Regex</a></h1><div class=content></div></section><section id=exec><h1><a href=#exec>Exec</a></h1><div class=content></div></section><section id=github><h1><a href=#github>GitHub</a></h1><div class=content></div></section><section id=auth><h1><a href=#auth>Auth</a></h1><div class=content></div></section><section id=faq><h1><a href=#faq>FAQ</a></h1><div class=content></div></section></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner><ul><li><a href=https://www.dailymotion.com>Dailymotion</a></li></ul></div></div></div></div></div><script type=text/javascript src=js/scripts.min.eaf147370baecdd07c022597db631f99cab1c9cd6479de586f30327a568d6a0f.js></script></body></html>